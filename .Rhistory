tab <- tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR("Depression")
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(subsitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
dummy
tally_OR <- function(x, data = data_comorb){
tab <- tally(subsitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
dummy
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(subsitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(substitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
dummy
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
attach(data)
tally_OR <- function(x, data = data_comorb){
tab <- tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
detach(data)
tally_OR <- function(x, data = data_comorb){
tab <- tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
dummy <- tally_OR(data_comorb$Depression)
dummy
dummy <- tally_OR(Depression)
detach(data)
tally_OR <- function(x, data = data_comorb){
tab <- tally(substitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR("Depression")
dummy
tally_OR <- function(x, data = data_comorb){
tab <- tally(substitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR("Depression")
debug(tally_OR)
tally_OR <- function(x, data = data_comorb){
tab <- tally(substitute(x) ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR("Depression")
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(data$x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(data$x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
tally_OR <- function(x, data = data_comorb){
tab <- tally(data_comorb$x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
tally_OR <- function(x, data = data_comorb){
tab <- table(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
data_comorb %>%
count(Depression, responder_3m)
tally_OR <- function(x, data = data_comorb){
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <- tally_OR(Depression)
data_comorb %>%
dplyr::tally(Depression, responder_3m)
data %>%
select(Depression:GAD, responder_3m) %>%
na.omit -> data_comorb
data_comorb %>%
dplyr::tally(Depression, responder_3m)
data_comorb %>%
dplyr::count(Depression, responder_3m)
data_comorb %>%
mosaic::tally(Depression ~ responder_3m, data =.)
dummy <-
lapply(data_comorb, function(x) tally(x ~ responder_3m, data = data_comorb)
)
dummy <-
lapply(data_comorb, function(x) {
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb))
mosaic::oddsRatio(tab)
}
dummy <-
lapply(data_comorb, function(x) {
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb)
mosaic::oddsRatio(tab)
})
data %>%
select(Depression:GAD) %>%
na.omit -> data_comorb
dummy <-
lapply(data_comorb, function(x) {
tab <- mosaic::tally(x ~ data$responder_3m, data = data_comorb)
mosaic::oddsRatio(tab)
})
data %>%
select(Depression:GAD) %>%
select(-one_of(nzv_vars)) %>%
na.omit -> data_comorb
dummy <-
lapply(data_comorb, function(x) {
tab <- mosaic::tally(x ~ data$responder_3m, data = data_comorb)
mosaic::oddsRatio(tab)
})
dummy <-
lapply(data_comorb, function(x) {
tab <- mosaic::tally(x ~ data$responder_3m, data = data_comorb)
})
dummy[[1]]
data %>%
select(Depression:GAD) %>%
select(-one_of(nzv_vars)) %>%
na.omit -> data_comorb
View(data_comorb)
dummy <-
lapply(data_comorb, function(x) {
tab <- mosaic::tally(x ~ na.omit(data$responder_3m), data = data_comorb)
})
data %>%
select(Depression:GAD, responder_3m) %>%
select(-one_of(nzv_vars)) %>%
na.omit -> data_comorb
dummy <-
lapply(select(data_comorb, -responder_3m),
function(x) {
tab <- mosaic::tally(x ~ data_comorb$responder_3m, data = data_comorb)
})
mosaic::tally(Depression ~ responder_3m, data =.)
dummy <-
lapply(select(data_comorb, -responder_3m),
function(x) {
tab <- mosaic::tally(x ~ data_comorb$responder_3m, data = data_comorb)
oddsRatio(tab)
})
dummy
dummy <-
lapply(select(data_comorb, -responder_3m),
function(x) {
tab <- mosaic::tally(x ~ $responder_3m, data = data_comorb)
oddsRatio(tab)
})
dummy <-
lapply(select(data_comorb, -responder_3m),
function(x) {
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
})
dummy
tally_OR <- function(x, data = data_comorb){
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <-
lapply(select(data_comorb, -responder_3m),
function(x) tall_OR(x))
tally_OR <- function(x, data = data_comorb){
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb)
oddsRatio(tab)
}
dummy <-
lapply(select(data_comorb, -responder_3m),
function(x) tally_OR(x))
dummy
data_comorb %>%
count(Depression, responder_3m)
data_comorb %>%
dplyr::count(Depression, responder_3m)
data_comorb %>%
group_by(Depression, responder_3m) %>%
summarise(n = n())
data_comorb %>%
group_by(Depression) %>%
summarise(n = n())
data_comorb %>%
group_by(Depression) %>%
summarise(n = n()) %>%
ggplot(aes(x = Depression, group = responder_3m, y = n)) +
geom_bar(stat = "identity")
data_comorb %>%
group_by(Depression, responder_3m) %>%
summarise(n = n()) %>%
ggplot(aes(x = Depression, group = responder_3m, y = n)) +
geom_bar(stat = "identity")
data_comorb %>%
group_by(Depression, responder_3m) %>%
summarise(n = n()) %>%
ggplot(aes(x = Depression, group = responder_3m, y = n, fill = responder_3m)) +
geom_bar(stat = "identity")
data_comorb %>%
group_by(Depression, responder_3m) %>%
summarise(n = n()) %>%
ggplot(aes(x = Depression, group = factor(responder_3m), y = n, fill = responder_3m)) +
geom_bar(stat = "identity")
data_comorb %>%
group_by(Depression, factor(responder_3m)) %>%
summarise(n = n()) %>%
ggplot(aes(x = Depression, group = responder_3m, y = n, fill = responder_3m)) +
geom_bar(stat = "identity")
data_comorb %>%
group_by(Depression, responder_3m) %>%
summarise(n = n()) %>%
ggplot(aes(x = Depression, group = factor(responder_3m), y = n, fill = factor(responder_3m))) +
geom_bar(stat = "identity")
tally_RR <- function(x, data = data_comorb){
tab <- mosaic::tally(x ~ responder_3m, data = data_comorb)
relrisk(tab)
}
comorb_RR <-
lapply(select(data_comorb, - responder_3m),
function(x) tally_RR(X))
comorb_RR <-
lapply(select(data_comorb, - responder_3m),
function(x) tally_RR(x))
comorb_RR
names(comorb_RR)
flatten(comorb_RR)
comorb_RR_df <- data_frame(comorb_diag = names(comorb_RR),
RelRisk = flatten(comorb_RR))
View(comorb_RR_df)
comorb_RR_df %>%
ggplot(aes(x = comorb_diag, y = RelRisk)) + geom_point()
View(comorb_RR_df)
as.vector(comorb_RR)
unlist(comorb_RR)
comorb_RR_df <- data_frame(comorb_diag = names(comorb_RR),
RelRisk = unlist(comorb_RR))
comorb_RR_df %>%
ggplot(aes(x = comorb_diag, y = RelRisk)) + geom_point()
comorb_RR_df %>%
ggplot(aes(x = reorder(comorb_diag, RelRisk), y = RelRisk)) + geom_point()
comorb_RR_df %>%
ggplot(aes(x = reorder(comorb_diag, RelRisk), y = RelRisk)) + geom_point() +
coord_flip()
comorb_OR_df <- data_frame(comorb_diag = names(comorb_OR),
RelRisk = unlist(comorb_OR))
comorb_OR <-
lapply(select(data_comorb, -responder_3m),
function(x) tally_OR(x))
comorb_OR_df <- data_frame(comorb_diag = names(comorb_OR),
RelRisk = unlist(comorb_OR))
comorb_OR_df <- data_frame(comorb_diag = names(comorb_OR),
OR = unlist(comorb_OR))
comorb_RR_df %>%
ggplot(aes(x = reorder(comorb_diag, OR), y = OR)) + geom_point() +
coord_flip() +
ggtitle("Relative Risks of comorbity diagnoses")
comorb_OR_df <- data_frame(comorb_diag = names(comorb_OR),
OR = unlist(comorb_OR))
comorb_OR_df %>%
ggplot(aes(x = reorder(comorb_diag, OR), y = OR)) + geom_point() +
coord_flip() +
ggtitle("Relative Risks of comorbity diagnoses")
table_r <- function(x){
table(select(data_comorb, x, responder_3m))}
table_r(Depression)
table_r <- function(x){
table(select(data_comorb, substitute(x), responder_3m))
}
table_r(Depression)
table_r <- function(x){
table(select(data_comorb, deparse(x), responder_3m))
}
table_r(Depression)
table_r <- function(x){
table(select(data_comorb, x, responder_3m))
}
table_r(Depression)
table(select(data_comorb, Depression, responder_3m))
table(select(data_comorb, vars(Depression, responder_3m)))
data_comorb %>%
map(data_comorb, table(., responder_3m))
source('~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/R_code/dummy.R')
library(dplyr)
?sample
df <- data_frame(p1 = sample(c(0,1), n = 100, replace = TRUE),
p2 = sample(c(0,1), n = 100, replace = TRUE),
p3 = sample(c(0,1), n = 100, replace = TRUE),
outcome = sample(c(0,1), n = 100, replace = TRUE))
sample(c(0,1), size = 10)
sample(c(0,1), size = 10, replace = TRUE)
sample(c(0,1), n = 100, replace = TRUE)
df <- data_frame(p1 = sample(c(0,1), size = 100, replace = TRUE),
p2 = sample(c(0,1), size = 100, replace = TRUE),
p3 = sample(c(0,1), size = 100, replace = TRUE),
outcome = sample(c(0,1), n = 100, replace = TRUE))
df <- data_frame(p1 = sample(c(0,1), size = 100, replace = TRUE),
p2 = sample(c(0,1), size = 100, replace = TRUE),
p3 = sample(c(0,1), size = 100, replace = TRUE),
outcome = sample(c(0,1), size = 100, replace = TRUE))
df %>%
do(table(df$., df$outcome))
df %>%
do(head(., 2))
df %>%
do(table(., df$outcome))
df %>%
do(table(.))
df %>%
do(table(.)) %>% tidy
df %>%
do(tidy(table(.)) )
df %>%
do(tidy(table(.)) ) -> df2
tidy(table(df$p1))
View(df2)
df %>%
do(nest(table(.)) ) -> df2
df %>%
do(table(.)) -> df2
df %>%
do(table(.))
df %>%
do(lm(outcome ~ ., data = .))
library(dplyr)
df <- data_frame(p1 = sample(c(0,1), size = 100, replace = TRUE),
p2 = sample(c(0,1), size = 100, replace = TRUE),
p3 = sample(c(0,1), size = 100, replace = TRUE),
outcome = sample(c(0,1), size = 100, replace = TRUE))
df %>%
do(lm(outcome ~ ., data = .))
df %>%
do(head(., 2))
df %>%
do(table(., 2))
table(df$p1)
l1 <- lapply(df, function(x) table(x, df$outcome))
l1 <- lapply(df, function(x) table(x, df$outcome))
l1
et.seed(42)
df <- data_frame(p1 = sample(c(0,1), size = 100, replace = TRUE),
p2 = sample(c(0,1), size = 100, replace = TRUE),
p3 = sample(c(0,1), size = 100, replace = TRUE),
outcome = sample(c(0,1), size = 100, replace = TRUE))
# does not work:
df %>%
do(table(., 2))
# works:
table(df$p1)
l1 <- lapply(df, function(x) table(x, df$outcome))
l1
library(purrr)
dummy <- map(l1, sum)
dummy <- map(l1, .[1,1] + .[1,2])
1:10 %>%
map(function(x) rnorm(10, x))
dummy <- map(l1, function(x) sum([[x]])
dummy <- map(l1, function(x) sum(x))
map(l1, function(x) sum(x))
map(l1, function(x) sum(c(x[[1,1]], x[[1,2]]))
)
l1[[4]]
l1[[3]]
dummy <- map(l1, function(x) sum(c(x[[1,1]], x[[1,2]])))
dummy
unlist(dummy)
map(df, function(x) table(x, df$outcome))
df %>%
do(table(.))
df %>%
do(table())
map(function(x) table(x, df$outcome))
map(df, function(x) table(x, df$outcome))
l1 <- map(df, function(x) table(x, df$outcome))
map(l1, function(x) sum(c(x[[1,1]], x[[1,2]])))
sums <- map(l1, function(x) sum(c(x[[1,1]], x[[1,2]])))
data_frame(sums)
data_frame(unlist(sums))
data_frame(sums = unlist(sums))
x <- c(5, 1, 3, 2, 2, NA)
row_number(x)
min_rank(x)
dense_rank(x)
percent_rank(x)
cume_dist(x)
library(dplyr)
library(ggplot2)
library(tidyr)
library(tibble)
library(broom)
library(purrr)
# define paths
path_data <- "~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/raw_data"
path_file_data <- "~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/raw_data/BiPOCD prediction.csv"
path_code <- "~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/R_code"
path_figs <- "~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/Figures"
path_obj <- "~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/data_objects"
# load data
data <- read_csv(path_file_data)
# constants
red1 <- "#880011"
library(readr)
data <- read_csv(path_file_data)
data %>%
select(Depression:GAD) %>%
select(-one_of(nzv_vars)) %>%
cor -> cor_comorb
data %>%
nearZeroVar(., saveMetrics = TRUE) %>%
rownames_to_column() %>%
filter(nzv == TRUE) -> data_nzv
nzv_vars <- data_nzv$rowname
library(caret)
data %>%
nearZeroVar(., saveMetrics = TRUE) %>%
rownames_to_column() %>%
filter(nzv == TRUE) -> data_nzv
nzv_vars <- data_nzv$rowname
data %>%
select(Depression:GAD) %>%
select(-one_of(nzv_vars)) %>%
cor -> cor_comorb
library(mosaic)
plot_mosaic <- function(x, df = data_comorb...){
tally_pred_resp <- mosaic::tally(x ~ responder_3m, data = df)
mosaicplot(tally_pred_resp)
}
plotmosaic(Depression)
plot_mosaic(Depression)
View(cor_comorb)
data %>%
select(Depression:GAD, responder_3m) %>%
select(-one_of(nzv_vars)) %>%
na.omit -> data_comorb
plot_mosaic <- function(x, df = data_comorb){
tally_pred_resp <- mosaic::tally(x ~ responder_3m, data = df)
mosaicplot(tally_pred_resp)
}
plot_mosaic(Depression)
plot_mosaic("Depression")
tally(Depression ~ responder_3m, data = data_comorb)
plot_mosaic(data_comorb$Depression)
lapply(data_comorb, plot_mosaic)
names(data_comorb)
plot_mosaic <- function(x, y){
tally_pred_resp <- table(x, y)
mosaicplot(tally_pred_resp)
}
lapply(data_comorb, plot_mosaic)
plot_mosaic <- function(x, df = data_comorb){
tally_pred_resp <- table(x, df$responder_3m)
mosaicplot(tally_pred_resp)
}
lapply(data_comorb, plot_mosaic)
source('~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/R_code/dummy.R')
debug(plot_mosaic)
lapply(data_comorb, plot_mosaic)
tally_pred_resp
tally_pred_resp
undebug(plot_mosaic)
plot_mosaic <- function(x, df = data_comorb){
tally_pred_resp <- table(x, df$responder_3m)
print(mosaicplot(tally_pred_resp))
}
lapply(data_comorb, plot_mosaic)
undebug(plot_mosaic)
plot_mosaic <- function(x, df = data_comorb){
tally_pred_resp <- table(x, df$responder_3m)
print(mosaicplot(tally_pred_resp, xlab = tally_pred_resp))
}
lapply(data_comorb, plot_mosaic)
undebug(plot_mosaic)
plot_mosaic <- function(x, df = data_comorb){
tally_pred_resp <- table(x, df$responder_3m)
print(mosaicplot(tally_pred_resp, xlab = x))
}
lapply(data_comorb, plot_mosaic)
undebug(plot_mosaic)
plot_mosaic <- function(x, df = data_comorb){
tally_pred_resp <- table(x, df$responder_3m)
print(mosaicplot(tally_pred_resp, xlab = x, ylab = df$responder_3m))
}
lapply(data_comorb, plot_mosaic)
source('~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/R_code/dummy.R')
source('~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/R_code/dummy.R')
source('~/Documents/OneDrive/Forschung/Online_Behavior_Therapy/R_code/dummy.R')
